    ##CONFLICTOS SOCIO-AMBIENTALES: UN ESTUDIO SOBRE LAS CAUSAS DE SU EXISTENCIA

    Brayan Aguilar Mori (20162215)
    Claudia Escobar Pimentel (20164942)
    Maria Emma Macedo (20161246)


    ##LIMPIEZA DE DATAS

    1. VARIABLE DEPENDIENTE
      1.1. VARIABLE DE CONFLICTOS SOCIOAMBIENTALES
```{r}
link_conflic="https://docs.google.com/spreadsheets/d/e/2PACX-1vQEBjAgqJAtszOistKAb5zOKf3REIqYZwYehRA0XMEKW1uCR1Xbop3pRkU6zerVACMztj4nlGoO6Oq_eg2dIXk/pub?gid=124092290&single=true&output=csv"
conflictos= read.csv(link_conflic, stringsAsFactors = F)
conflictos=conflictos[grep("SOCIOAMBIENTAL", conflictos$TIPO),]
conflictos$vigencia1= ifelse(conflictos$ANIO_inicio<2017, 2,0)
conflictos$vigencia= ifelse(conflictos$ANIO_inicio>2009, 1,0)
conflictos=conflictos[grep("1", conflictos$vigencia),]
conflictos=conflictos[grep("2", conflictos$vigencia1),]
conflictos= as.data.frame(table(conflictos$Provincia))
colnames(conflictos)= c("PROVINCIA", "N_CONF")
conflictos[94,2]= 6
conflictos= conflictos[-95,]
conflictos$PROVINCIA=gsub("Ñ","N", conflictos$PROVINCIA)
conflictos$PROVINCIA=gsub("RAYMONDI","RAIMONDI", conflictos$PROVINCIA)
conflictos$PROVINCIA=gsub("NAZCA","NASCA", conflictos$PROVINCIA)
conflictos$PROVINCIA= trimws(conflictos$PROVINCIA, whitespace = "[\\h\\v]")
```

    2. VARIABLES INDEPENDIENTES
      2.1. VARIABLE MEDIOAMBIENTAL
        2.1.1. NUMERO DE DENUNCIAS AMBIENTALES RECIBIDAS EN LA MUNICIPALIDAD DEL 2011 AL 2016
```{r}
# DENUNCIAS DEL AÑO 2011

Linkma2011="https://docs.google.com/spreadsheets/d/e/2PACX-1vS8IH9RstwYlicGpuz2SGuwLMDzaKXaC2iW2ghcRZ9fAYDrXGmdVrqsvXy8PuK3nP-rwiaEutXy7dZ1/pub?gid=1982912224&single=true&output=csv"
denuncia2011= read.csv(Linkma2011, stringsAsFactors = F)
denuncia2011=denuncia2011[,c(7,9,12,13,14,15)]
colnames(denuncia2011)= c("PROVINCIA","NIVEL_MUN", "DENUN_AGUA11", "DENUN_SUELO11", "DENUN_AIRE11", "DENUN_BOSQUE11")
denuncia2011$PROVINCIA=trimws(denuncia2011$PROVINCIA, whitespace = "[\\h\\v]")
#Eliminamos las municipalidades distritales y solo nos quedamos con las provinciales
denuncia2011$NIVEL_MUN=gsub("2", "", denuncia2011$NIVEL_MUN) 
denuncia2011[,c(2:6)]=lapply(denuncia2011[,c(2:6)], as.numeric)
denuncia2011=denuncia2011[complete.cases(denuncia2011$NIVEL_MUN),]
denuncia2011$NIVEL_MUN=NULL
denuncia2011$DENUN_TOTAL2011=rowSums(denuncia2011[,c(2:5)])
denuncia2011=denuncia2011[,c(1,6)]

#DENUNCIAS DEL AÑO 2012
Linkma2012="https://docs.google.com/spreadsheets/d/e/2PACX-1vTGBSQ7datZkR04Z33PGUP3knCe57BHi8ZsgXKw9504WGbkErfjOrne6ZxCHiETs7KXSPsZ5bjdTwmo/pub?gid=859331191&single=true&output=csv"
denuncia2012= read.csv(Linkma2012, stringsAsFactors = F)
denuncia2012=denuncia2012[,c(6,8,11,12,13,14)]
colnames(denuncia2012)= c("PROVINCIA","NIVEL_MUN", "DENUN_AGUA12", "DENUN_SUELO12", "DENUN_AIRE12", "DENUN_BOSQUE12")
denuncia2012$PROVINCIA=trimws(denuncia2012$PROVINCIA, whitespace = "[\\h\\v]")
denuncia2012$NIVEL_MUN= gsub("2", "", denuncia2012$NIVEL_MUN)
denuncia2012[,c(2:6)]=lapply(denuncia2012[,c(2:6)],as.numeric)
denuncia2012=denuncia2012[complete.cases(denuncia2012$NIVEL_MUN),]
denuncia2012$NIVEL_MUN=NULL
denuncia2012$DENUN_TOTAL2012=rowSums(denuncia2012[,c(2:5)])
denuncia2012=denuncia2012[,c(1,6)]

#DENUNCIAS DEL AÑO 2013
Linkma2013="https://docs.google.com/spreadsheets/d/e/2PACX-1vQHHatSXaukijMVZK7YScuJR2977yb5_gp_INZiNUkRChK2T7U7OO0CRn7X8WleTj2tQrd8G-SHNEB4/pub?gid=1165794550&single=true&output=csv"
denuncia2013= read.csv(Linkma2013, stringsAsFactors = F)
denuncia2013=denuncia2013[,c(6,8,11,12,13,14)]
colnames(denuncia2013)= c("PROVINCIA", "NIVEL_MUN", "DENUN_AGUA2013", "DENUN_SUELO2013", "DENUN_AIRE2013", "DENUN_BOSQUE2013")
denuncia2013$PROVINCIA=trimws(denuncia2013$PROVINCIA, whitespace = "[\\h\\v]")
denuncia2013$NIVEL_MUN= gsub("2", "", denuncia2013$NIVEL_MUN)
denuncia2013[,c(2:6)]=lapply(denuncia2013[,c(2:6)], as.numeric)
denuncia2013=denuncia2013[complete.cases(denuncia2013$NIVEL_MUN),]
denuncia2013$NIVEL_MUN=NULL
denuncia2013$DENUN_TOTAL2013=rowSums(denuncia2013[,c(2:5)])
denuncia2013=denuncia2013[,c(1,6)]

#DENUNCIAS DEL AÑO 2014
Linkma2014="https://docs.google.com/spreadsheets/d/e/2PACX-1vRykHL8j1FHzFA6zQXRxtn1Otg4FPCxNfsswB33oCzinA-yIo3r3qnflYX0Jsnt3oiHO895CQaEod6N/pub?gid=1648589148&single=true&output=csv"
denuncia2014= read.csv(Linkma2014, stringsAsFactors = F)
denuncia2014=denuncia2014[,c(6,8,11,14,17,20)]
colnames(denuncia2014)= c("PROVINCIA","NIVEL_MUN", "DENUN_AGUA2014", "DENUN_SUELO2014", "DENUN_AIRE2014", "DENUN_BOSQUE2014")
denuncia2014$NIVEL_MUN= gsub("2", "", denuncia2014$NIVEL_MUN)
denuncia2014[,c(2:6)]=lapply(denuncia2014[,c(2:6)], as.numeric)
denuncia2014=denuncia2014[complete.cases(denuncia2014$NIVEL_MUN),]
denuncia2014$NIVEL_MUN=NULL
denuncia2014$DENUN_TOTAL2014=rowSums(denuncia2014[,c(2:5)])
denuncia2014=denuncia2014[,c(1,6)]

#DENUNCIAS DEL AÑO 2015
Linkma2015="https://docs.google.com/spreadsheets/d/e/2PACX-1vR3ICQShacvgbgPnREM4g-wyKW2lDfVGcs3Vi0b2nW4yzanl6PziCB_ZKC5UZHOxwl0Fa_P6T9bdMB9/pub?gid=32088135&single=true&output=csv"
denuncia2015= read.csv(Linkma2015, stringsAsFactors = F)
denuncia2015=denuncia2015[,c(6,8,11,14,17,20)]
colnames(denuncia2015)= c("PROVINCIA", "NIVEL_MUN", "DENUN_AGUA2015", "DENUN_SUELO2015", "DENUN_AIRE2015", "DENUN_BOSQUE2015")
denuncia2015$PROVINCIA=gsub("NASCA", "NAZCA", denuncia2015$PROVINCIA)
denuncia2015$NIVEL_MUN=gsub("2", "", denuncia2015$NIVEL_MUN)
denuncia2015[,c(2:6)]=lapply(denuncia2015[,c(2:6)], as.numeric)
denuncia2015=denuncia2015[complete.cases(denuncia2015$NIVEL_MUN),]
denuncia2015$NIVEL_MUN=NULL
denuncia2015$DENUN_TOTAL2015=rowSums(denuncia2015[,c(2:5)])
denuncia2015=denuncia2015[,c(1,6)]

#DENUNCIAS DEL AÑO 2016
Linkma2016="https://docs.google.com/spreadsheets/d/e/2PACX-1vQMGqf05nKd6gK-Rwg80nNVqtypd0o9y-F-ImSCMzp7lbQs_2iyhPMQ3efU1tSM-7gxYvBceUGYI3Rh/pub?gid=583142682&single=true&output=csv"
denuncia2016= read.csv(Linkma2016, stringsAsFactors = F)
denuncia2016=denuncia2016[,c(6,8,12,15,18,21)]
colnames(denuncia2016)= c("PROVINCIA","NIVEL_MUN", "DENUN_AGUA2016", "DENUN_SUELO2016", "DENUN_AIRE2016", "DENUN_BOSQUE2016")
denuncia2016$PROVINCIA=gsub("NASCA", "NAZCA", denuncia2016$PROVINCIA)
denuncia2016$NIVEL_MUN= gsub("2", "", denuncia2016$NIVEL_MUN)
denuncia2016[,c(2:6)]=lapply(denuncia2016[,c(2:6)], as.numeric)
denuncia2016=denuncia2016[complete.cases(denuncia2016$NIVEL_MUN),]
denuncia2016$NIVEL_MUN=NULL
denuncia2016$DENUN_TOTAL2016=rowSums(denuncia2016[,c(2:5)])
denuncia2016=denuncia2016[,c(1,6)]

#MERGE DE LAS DATAS SOBRE DENUNCIAS 
denuncia1=merge(denuncia2011, denuncia2012, all.x = T, all.y = T, by="PROVINCIA")
denuncia2= merge(denuncia1, denuncia2013, all.x = T, all.y = T, by="PROVINCIA")
denuncia3= merge(denuncia2, denuncia2014, all.x = T, all.y=T, by= "PROVINCIA")
denuncia4= merge(denuncia3, denuncia2015, all.x = T, all.y=T, by= "PROVINCIA")
denuncias_municipalidades= merge(denuncia4, denuncia2016, all.x=T, all.y=T, by="PROVINCIA")

# VARIABLE CON TODAS LAS DENUNCIAS AMBIENTALES RECIBIDAS EN LAS MUNICIPALIDADES DEL 2011 AL 2016
denuncias_municipalidades$DENUNCIAS_TOTALES=rowSums(denuncias_municipalidades[,c(2:7)], na.rm=T)
denuncias_municipalidades=denuncias_municipalidades[,c(1,8)]
```

    2.1.2.ALTITUD DE PROVINCIAS Y MERGE DE LA VARIABLE AMBIENTAL
```{r}
Linkaltitud= "https://docs.google.com/spreadsheets/d/e/2PACX-1vR49v52lH-TScVkHSrCmbvAqal36DEEQJgGT-v8fXt5gbQusXt7sb0CdQ7qMeIVbaQe1KD4NbW06e1i/pub?gid=1888885268&single=true&output=csv"
altitud= read.csv(Linkaltitud, stringsAsFactors = F) 
altitud$ALTITUD=gsub(" ","", altitud$ALTITUD)
altitud$ALTITUD= as.numeric(altitud$ALTITUD)
altitud$PROVINCIA=gsub("RAIMONDI", "RAYMONDI", altitud$PROVINCIA)
altitud$PROVINCIA=gsub("MARANON", "MARAÑON", altitud$PROVINCIA)
altitud$PROVINCIA=gsub("FERRENAFE", "FERREÑAFE", altitud$PROVINCIA)
altitud$PROVINCIA=gsub("VILCASHUAMAN", "VILCAS HUAMAN", altitud$PROVINCIA)

#MERGE DE LA DATA DE DENUNCIAS MÁS LA DATA DE ALTITUD
DATA_AMBIENTAL= merge(altitud,denuncias_municipalidades, all.x=T, all.y=T, by="PROVINCIA")
DATA_AMBIENTAL$PROVINCIA=gsub("RAYMONDI", "RAIMONDI", DATA_AMBIENTAL$PROVINCIA)
DATA_AMBIENTAL$PROVINCIA= gsub("NAZCA", "NASCA", DATA_AMBIENTAL$PROVINCIA)
DATA_AMBIENTAL$PROVINCIA=gsub("Ñ", "N", DATA_AMBIENTAL$PROVINCIA)
```

    2.2. VARIABLE DE DESARROLLO SOCIAL
      2.2.1. LIMPIEZA PROGRAMA JUNTOS Y QALI WARMA
```{r}
#JUNTOS Y QW DEL 2013
Linkps2013="https://docs.google.com/spreadsheets/d/e/2PACX-1vSiOQTUpUvlls7TPtdRw1nCeNUxS4IISg2lTUlD-NGX3aTf9vWJaCLFWWNxFYAqttoK6bDRn7YTHuTQ/pub?gid=567875646&single=true&output=csv"
Prog_soc2013= read.csv(Linkps2013, stringsAsFactors = F)
Prog_soc2013=Prog_soc2013[-c(1:7,203),c(1,3,5,7,9,11,13,15,17,19,21,23,25,27,29,31,33,35,37)]
Prog_soc2013[,c(2:19)]=lapply(Prog_soc2013[,c(2:19)], as.numeric)
Prog_soc2013$JUNTOS2013=rowSums(Prog_soc2013[,c(2,4,6,8,10,12,14,16,18)], na.rm = T)/9
Prog_soc2013$QW2013=rowSums(Prog_soc2013[,c(3,5,7,9,11,13,15,17,19)], na.rm = T)/9
Prog_soc2013=Prog_soc2013[,c(1,20,21)]
colnames(Prog_soc2013)= c("PROVINCIA", "JUNTOS2013","QW2013")

#JUNTOS Y QALI WARMA DEL 2014
Linkps2014_1="https://docs.google.com/spreadsheets/d/e/2PACX-1vQK2PB5SfwOMZNseMpOBevy7yjpi8-j03m8femNRNipo6ca3avFQVubB8eAT_jTEjw5FGaJbWObAFcG/pub?gid=221742920&single=true&output=csv"
Prog_soc2014_1= read.csv(Linkps2014_1, stringsAsFactors = F)
Prog_soc2014_1=Prog_soc2014_1[-c(1:6,202:218),-c(1,2,4,6,8,10,12,14,16,18,20,22,24,26,28,30,32,34,36,38,40,42)]
Prog_soc2014_1[,c(2:21)]=lapply(Prog_soc2014_1[,c(2:21)], as.numeric)
Linkps2014_2= "https://docs.google.com/spreadsheets/d/e/2PACX-1vTNN1zlIFSGvg5GADHsn8vRS_Dp8lZFMGpd2pcuRkPHnCdjAnWponv5IaKPoRCsAeDpbP7B5GoZq-st/pub?gid=228502094&single=true&output=csv"
Prog_soc2014_2=read.csv(Linkps2014_2, stringsAsFactors = F)
Prog_soc2014_2=Prog_soc2014_2[-c(1:6,203:223),-c(1,2,4,6,8,10)]
Prog_soc2014_2[,c(2:5)]=lapply(Prog_soc2014_2[,c(2:5)], as.numeric)
colnames(Prog_soc2014_2)= c("X.1", "JUNTOS11", "QW11","JUNTOS11", "QW11")
Prog_soc2014= merge(Prog_soc2014_1, Prog_soc2014_2, all.x=T, all.y=T, by="X.1")
Prog_soc2014$JUNTOS2014=rowSums(Prog_soc2014[,c(2,4,6,8,10,12,14,16,18,20,22,24)],na.rm=T)/12
Prog_soc2014$QW2014=rowSums(Prog_soc2014[,c(3,5,7,9,11,13,15,17,19,21,23,25)], na.rm=T)/12
Prog_soc2014=Prog_soc2014[,c(1,26,27)]
colnames(Prog_soc2014)= c("PROVINCIA", "JUNTOS2014","QW2014")

#JUNTOS Y QALI WARMA DEL 2015
Linkps2015= "https://docs.google.com/spreadsheets/d/e/2PACX-1vQNEAzGh_S55sekllUJYmeHlXqGqT6hPQgTwd-1oeahGj_wnixOssP1LXOms0OjgqnGT39oh_Tz48Pu/pub?gid=1890835755&single=true&output=csv"
Prog_soc2015= read.csv(Linkps2015, stringsAsFactors = F)
Prog_soc2015=Prog_soc2015[-c(1:6,203),-c(2,4,6,8,10,12,13,15,17,19,21,23,25,27,29,31,33,35,37,39,41,43,45,47,49)]
Prog_soc2015[,c(2:25)]=lapply(Prog_soc2015[,c(2:25)],as.numeric)
Prog_soc2015$JUNTOS2015=rowSums(Prog_soc2015[,c(2,4,6,8,10,12,14,16,18,20,22,24)], na.rm = T)/12
Prog_soc2015$QW2015=rowSums(Prog_soc2015[,c(3,5,7,9,11,13,15,17,19,21,23,25)], na.rm=T)/12
Prog_soc2015=Prog_soc2015[,c(1,26,27)]
colnames(Prog_soc2015)= c("PROVINCIA", "JUNTOS2015","QW2015")

#JUNTOS Y QALI WARMA DEL 2016
Linkps2016_1="https://docs.google.com/spreadsheets/d/e/2PACX-1vRBDpzrxsYMeYPAwMR6iz-gVyovtuDfIEZzayp-vN2yWSpKqY66R45jxIB763ZT3dIXwZOlMW-WP8GO/pub?gid=518413778&single=true&output=csv"
Prog_soc2016_1=  read.csv(Linkps2016_1, stringsAsFactors = F)
Prog_soc2016_1=Prog_soc2016_1[c(7:202),c(3,7,13,18,24,29,35,40,46,51,58,63,70,75,82,87,94,99,106,111,118,123,130)]
Prog_soc2016_1[,c(2:23)]=lapply(Prog_soc2016_1[,c(2:23)], as.numeric)
Linkps2016_2= "https://docs.google.com/spreadsheets/d/e/2PACX-1vQBqNRdWurMUOKsztXm3vQr5Kgp8LoxZmOBNeE8UqWAG3ZzKeB-Ipf0B92AuLDKa1ZWsqxstDqsH0jm/pub?gid=299644331&single=true&output=csv"
Prog_soc2016_2= read.csv(Linkps2016_2, stringsAsFactors = F)
Prog_soc2016_2=Prog_soc2016_2[c(3:198),c(1,3,5)]
Prog_soc2016_2[,c(2,3)]=lapply(Prog_soc2016_2[,c(2,3)], as.numeric)
colnames(Prog_soc2016_2)= c("X.1","JUNTOS","QW")
Prog_soc2016= merge(Prog_soc2016_1, Prog_soc2016_2, all.x=T, all.y=T, by="X.1")
Prog_soc2016$JUNTOS2016=rowSums(Prog_soc2016[,c(2,4,6,8,10,12,14,16,18,20,22,24)], na.rm=T)/12
Prog_soc2016$QW2016=rowSums(Prog_soc2016[,c(3,5,7,9,11,13,15,17,19,21,23,25)], na.rm=T)/12
Prog_soc2016=Prog_soc2016[,c(1,26,27)]
colnames(Prog_soc2016)= c("PROVINCIA","JUNTOS2016","QW2016")

#MERGE DE LAS DATAS DE JUNTIOS Y QW DEL 2013 AL 2016
prog1= merge(Prog_soc2013, Prog_soc2014, all.x=T, all.y=T, by="PROVINCIA")
prog2= merge(prog1, Prog_soc2015, all.x=T, all.y=T, by="PROVINCIA")
programas= merge(prog2, Prog_soc2016, all.x=T, all.y=T, by="PROVINCIA")
programas$PROVINCIA=gsub("MARAÑON","MARANON", programas$PROVINCIA)
programas$PROVINCIA=gsub("FERREÑAFE","FERRENAFE", programas$PROVINCIA)
programas$PROVINCIA=gsub("CAÑETE", "CANETE", programas$PROVINCIA)
```

    2.2.2. DATA DE NUMERO DE TOTAL DE ESTUDIANTES Y HOGARES POR PROVINCIA PARA SACAR LOS PORCENTAJES DE LA COBERTURA DE JUNTOS Y QW
```{r}
linkestu="https://docs.google.com/spreadsheets/d/e/2PACX-1vTFLsY-aknfVgffBMcrrGx2JCzCWubhHatrrkletjKHid_vfom_zkGSj2tiFBAJQ6HkHnazDuX1Y4p-/pub?gid=1314344806&single=true&output=csv"
estud= read.csv(linkestu, stringsAsFactors = F)
estud$X.1= as.numeric(estud$X.1)
colnames(estud)=c("PROVINCIA", "ESTUDIANTES")
estud$PROVINCIA=trimws(estud$PROVINCIA, whitespace = "[\\h\\v]")
Linkhogar="https://docs.google.com/spreadsheets/d/e/2PACX-1vTWnM9MqloQBlaT6kM20z3bLNYppU88Hto6KMOYUD0HHu3xi5Zu7EqUdyJ8tU-M38UxU7Y4luNsLuz4/pub?gid=891629502&single=true&output=csv"
hogares= read.csv(Linkhogar, stringsAsFactors = F)
hogares=hogares[-c(1:5,202:205),-c(1,2)]
hogares$X.2=gsub(" ","", hogares$X.2)
colnames(hogares)= c("PROVINCIA", "VIVIENDAS")
hogares$VIVIENDAS= as.numeric(hogares$VIVIENDAS)
hogares$PROVINCIA=gsub("MARAÑON", "MARANON", hogares$PROVINCIA)
hogares$PROVINCIA=gsub("CAÑETE", "CANETE", hogares$PROVINCIA)
hogares$PROVINCIA=gsub("FERREÑAFE", "FERRENAFE", hogares$PROVINCIA)

#MERGE DE ESTUDIANTES Y HOGARES CON JUNTOS Y QALI WARMA
ALUM_HOG=merge(estud, hogares, all.x=T, all.y=T, by="PROVINCIA")
MOVIL_SOCIAL= merge(programas, ALUM_HOG, all.x=T, all.y=T, by="PROVINCIA")
MOVIL_SOCIAL$JUNTOSTOTAL=rowSums(MOVIL_SOCIAL[,c(2,4,6,8)], na.rm=T)/4*100/MOVIL_SOCIAL$VIVIENDAS
MOVIL_SOCIAL$QWTOTAL=rowSums(MOVIL_SOCIAL[,c(3,5,7,9)], na.rm=T)/4*100/MOVIL_SOCIAL$ESTUDIANTES
MOVIL_SOCIAL[,c(12,13)]=round(MOVIL_SOCIAL[,c(12,13)], digits = 2)
MOVIL_SOCIAL=MOVIL_SOCIAL[,c(1,12,13)]
```

    2.2.3. INDICADOR SOBRE POBREZA MONETARIA
```{r}
Link_pob="https://docs.google.com/spreadsheets/d/e/2PACX-1vRCaUAJpyRU_STzOmgMACrnQOoAR6bUGuKvtWBFkumRge91rqX_vBHCfX0f1_ldB-wlaRCUcOdQ5HY5/pub?gid=1069941244&single=true&output=csv"
Pobre= read.csv(Link_pob, stringsAsFactors = F)
Pobre=Pobre[,c(3,6)]
Pobre$Promedio= as.numeric(Pobre$Promedio)
colnames(Pobre)= c("PROVINCIA","POBREZA")
Pobre$PROVINCIA=gsub("CAÑETE","CANETE", Pobre$PROVINCIA)
Pobre$PROVINCIA=gsub("MARAÑÓN", "MARANON", Pobre$PROVINCIA)
Pobre$PROVINCIA=gsub("FERREÃAFE", "FERRENAFE", Pobre$PROVINCIA)
Pobre$PROVINCIA=gsub("PROV. CONST. DEL CALLAO", "CALLAO", Pobre$PROVINCIA)

#MERGE DE MOVILIDAD SOCIAL Y POBREZA MONETARIA
DESA_SOC= merge(MOVIL_SOCIAL, Pobre, all.x=T, all.y=T, by="PROVINCIA")
```


    2.3. VARIABLE DE CONSULTA PREVIA
```{r}
LinkCP="https://docs.google.com/spreadsheets/d/e/2PACX-1vRjS6axYSJOHdMQAPmeU2S34tijXjhkmeNKf7R1n1N_TCcxgtbdwKr5-XPiqgwyY_lVr8lRezS_tHft/pub?gid=870128856&single=true&output=csv"
Con_Pre= read.csv(LinkCP, stringsAsFactors = F)
Con_Pre=Con_Pre[(-1),c(1,2)]
colnames(Con_Pre)= c("PROVINCIA", "HUBO_CONSULTA")
Con_Pre$HUBO= ifelse(Con_Pre$HUBO_CONSULTA=="SI",1,0)
```

    2.4. VARIABLE DE PARTICIPACION POLITICA
```{r}
LinkPP= "https://docs.google.com/spreadsheets/d/e/2PACX-1vTGKts8GzfjDMkP6bX_mhbr7vogH3kkJdC7ZkEyI_KT_7R3Xrsu_wT8qR8K2QVRyLK251kq2KmAPBzm/pub?gid=888974716&single=true&output=csv"
Par_pol= read.csv(LinkPP, stringsAsFactors = F)
Par_pol=Par_pol[(-1),]
colnames(Par_pol)= c("PROVINCIA","Blan_gen2011","Nulo_gen2011","Ause2011","Blan_gob2014","Nulo_gob2014","Blan_mun2014","Nulo_mun2014","Ause2014","Total_blan2014","Total_nulo2014","Blan_gen2016","Nulo_gen2016","Ause2016")
Par_pol[,c(2:14)]=lapply(Par_pol[,c(2:14)], as.numeric)
Par_pol$BLANCOS= rowSums(Par_pol[,c(2,5,7,12)],na.rm = T)/4
Par_pol$AUSENTISMO= rowSums (Par_pol[,c(4,9,14)], na.rm = T)/3
Par_pol=Par_pol[,c(1,15,16)]
```

    2.5. PRESENCIA DEL ESTADO
      2.5.1. ACCESO A AGUA,ELECTRICIDAD,SALUD Y DNI
```{r}
link="https://docs.google.com/spreadsheets/d/e/2PACX-1vTZwqZhEy1lNvtljlYGU8cWLGJdIR1_3zar9STgRHIsqGkF2_zmKlbvAwsaSAYjQ9ZdeHzkfpprqf4S/pub?gid=1105640224&single=true&output=csv"
data= read.csv(link, stringsAsFactors = F)
data=data[,c(2,3,8,12,18)]
data$TOTAL.AGUAPUBLICA= gsub(" ","", data$TOTAL.AGUAPUBLICA)
data$ELECTRICIDAD_SI= gsub(" ","", data$ELECTRICIDAD_SI)
data$SIS_SI= gsub(" ","", data$SIS_SI)
data$DNI_SI= gsub(" ","", data$DNI_SI)
data$PROVINCIA=gsub("HAUYLAS","HUAYLAS", data$PROVINCIA)
data$PROVINCIA=gsub("POMOBAMBA","POMABAMBA", data$PROVINCIA)
data$PROVINCIA= gsub("UCTUBAMBA", "UTCUBAMBA", data$PROVINCIA)
data[,c(2:5)]=lapply(data[,c(2:5)], as.numeric)
```

    2.5.2. POBLACION TOTAL POR PROVINCIA PARA CALCULAR PORCENTAJES
```{r}
link_pobla="https://docs.google.com/spreadsheets/d/e/2PACX-1vQppod903W4MW2pAC3gE7TXesvAUswcM3tmJNOZAON5DTFggLWjPHhxDliG3V3a7OfYLiIjV4fDWd8g/pub?gid=0&single=true&output=csv"
pobla_prov= read.csv(link_pobla, stringsAsFactors = F)
pobla_prov=pobla_prov[,c(4,7)]
pobla_prov$Total..2017.=as.numeric(pobla_prov$Total..2017.)
names(pobla_prov)= c("PROVINCIA","POBLACION")
pobla_prov$PROVINCIA=gsub("Á","A", pobla_prov$PROVINCIA)
pobla_prov$PROVINCIA=gsub("É","E", pobla_prov$PROVINCIA)
pobla_prov$PROVINCIA=gsub("Í","I", pobla_prov$PROVINCIA)
pobla_prov$PROVINCIA=gsub("Ó","O", pobla_prov$PROVINCIA)
pobla_prov$PROVINCIA=gsub("Ú","U", pobla_prov$PROVINCIA)
pobla_prov$PROVINCIA=gsub("Ñ","N", pobla_prov$PROVINCIA)
pobla_prov$PROVINCIA= gsub("PROV. CONST. DEL CALLAO", "CALLAO", pobla_prov$PROVINCIA)

#MERGE DE PRESENCIA ESTATAL Y POBLACION
DATA_PRES_EST=merge(data, pobla_prov, all.x=T, all.y=T, by="PROVINCIA")
DATA_PRES_EST$PORC_AGUA=(DATA_PRES_EST$TOTAL.AGUAPUBLICA)*100/DATA_PRES_EST$POBLACION
DATA_PRES_EST$POR_ELEC= (DATA_PRES_EST$ELECTRICIDAD_SI)*100/DATA_PRES_EST$POBLACION
DATA_PRES_EST$PORC_SIS= (DATA_PRES_EST$SIS_SI)*100/DATA_PRES_EST$POBLACION
DATA_PRES_EST$PORC_DNI= (DATA_PRES_EST$DNI_SI)*100/DATA_PRES_EST$POBLACION
```


    2.6. VARIABLE CARACTERISTICAS DEMOGRAFICAS
      2.6.1. ANALFABETISMO
```{r}
Link_alfa="https://docs.google.com/spreadsheets/d/e/2PACX-1vSIpLDQA-TINwLgJmlCbpnJdcdknxx7JIXcp13owZcJZqZbZQvA-7n0-Y8JmTTrSg/pub?gid=192903696&single=true&output=csv"
Alfa= read.csv(Link_alfa, stringsAsFactors = F)
Alfa=Alfa[,c(2,6)]
colnames(Alfa)= c("PROVINCIA", "ANALFABETISMO")
Alfa$ANALFABETISMO=gsub(",",".", Alfa$ANALFABETISMO)
Alfa$ANALFABETISMO= as.numeric(Alfa$ANALFABETISMO)
Alfa$PROVINCIA= trimws(Alfa$PROVINCIA, whitespace = "[\\h\\v]")
```

    2.6.2.DIMENSION DE COMUNIDADES CAMPESINAS E INDIGENAS
```{r}
Link_Comu="https://docs.google.com/spreadsheets/d/e/2PACX-1vQUfpY61su7sYhZdkRZqEG7CyEJRgp8B6GC8lxdmRuvfBnqTvHFesoiFs5Bxqf9Ds75FoNG_oRwaPqV/pub?gid=55057775&single=true&output=csv"
Comu= read.csv(Link_Comu, stringsAsFactors = F)
Comu=Comu[,c(3:5)]
colnames(Comu)= c("PROVINCIA","COM_INDI","COMU_CAMP")
Comu[,c(2,3)]=lapply(Comu[,c(2,3)], as.numeric)
Comu$PROVINCIA= gsub("NAZCA", "NASCA", Comu$PROVINCIA)
Comu[158,2]=0
```

    2.6.3. DIMENSION MORTALIDAD
```{r}
#MORTALIDAD DEL 2011
link_m11="https://docs.google.com/spreadsheets/d/e/2PACX-1vSpNg7L_Q9TdHF_s7sLSWtnXeQUgsPruiUrJP2U7uGRg6v59FSIV-ZHZVYTbtM8bA/pub?gid=2008230855&single=true&output=csv"
mortalidad_2011= read.csv(link_m11, stringsAsFactors = F)
mortalidad_2011=mortalidad_2011[grep("A|B|C|D|E|F|G|H|I|J|K|L|M|N|O|P|Q|R|S|T|U|V|W|X|Y|Z",mortalidad_2011$X),]
mortalidad_2011=mortalidad_2011[-grep("EUROPA|ASIA|AMERICA",mortalidad_2011$X),]
mortalidad_2011=mortalidad_2011[,c(2,4)]
mortalidad_2011$X.2=trimws(mortalidad_2011$X.2, whitespace = "[\\h\\v]")
mortalidad_2011$X.2=gsub(" ","", mortalidad_2011$X.2)
mortalidad_2011$X.2= as.numeric(mortalidad_2011$X.2)
colnames(mortalidad_2011)= c("PROVINCIA", "MORTA_11")
mortalidad_2011$PROVINCIA=gsub("Á","A", mortalidad_2011$PROVINCIA)
mortalidad_2011$PROVINCIA=gsub("É","E", mortalidad_2011$PROVINCIA)
mortalidad_2011$PROVINCIA=gsub("Í","I", mortalidad_2011$PROVINCIA)
mortalidad_2011$PROVINCIA=gsub("Ó","O", mortalidad_2011$PROVINCIA)
mortalidad_2011$PROVINCIA=gsub("Ú","U", mortalidad_2011$PROVINCIA)
mortalidad_2011$PROVINCIA=gsub("Ñ","N", mortalidad_2011$PROVINCIA)
mortalidad_2011$PROVINCIA=gsub("NAZCA","NASCA", mortalidad_2011$PROVINCIA)

#MORTALIDAD 2012
link_m12="https://docs.google.com/spreadsheets/d/e/2PACX-1vQsuJy2d_L8c3j5TF7_tBC6WsQDtUjz2DEY0GsOZ9D7JOXYnCtZhmrXXTF4Go0T1g/pub?gid=1347988990&single=true&output=csv"
mortalidad_2012= read.csv(link_m12, stringsAsFactors = F)
mortalidad_2012=mortalidad_2012[grep("A|B|C|D|E|F|G|H|I|J|K|L|M|N|O|P|Q|R|S|T|U|V|W|X|Y|Z",mortalidad_2012$X),]
mortalidad_2012=mortalidad_2012[-grep("EUROPA|ASIA|AMERICA",mortalidad_2012$X),]
mortalidad_2012=mortalidad_2012[,c(2,4)]
mortalidad_2012$X.2=trimws(mortalidad_2012$X.2, whitespace = "[\\h\\v]")
mortalidad_2012$X.2=gsub("\\.","", mortalidad_2012$X.2)
mortalidad_2012$X.2=as.numeric(mortalidad_2012$X.2)
colnames(mortalidad_2012)= c("PROVINCIA", "MORTA_12")
mortalidad_2012$PROVINCIA=gsub("Á","A", mortalidad_2012$PROVINCIA)
mortalidad_2012$PROVINCIA=gsub("É","E", mortalidad_2012$PROVINCIA)
mortalidad_2012$PROVINCIA=gsub("Í","I", mortalidad_2012$PROVINCIA)
mortalidad_2012$PROVINCIA=gsub("Ó","O", mortalidad_2012$PROVINCIA)
mortalidad_2012$PROVINCIA=gsub("Ú","U", mortalidad_2012$PROVINCIA)
mortalidad_2012$PROVINCIA=gsub("Ñ","N", mortalidad_2012$PROVINCIA)
mortalidad_2012$PROVINCIA=gsub("NAZCA","NASCA", mortalidad_2012$PROVINCIA)

#MORTALIDAD 2013
link_m13="https://docs.google.com/spreadsheets/d/e/2PACX-1vTKSKOjYzaZkRyYMO6WxNtepG0i8qdSZ8t83iR_qHNzBbsryLspuvuSLo-wbpbKaw/pub?gid=1695364271&single=true&output=csv"
mortalidad_2013= read.csv(link_m13, stringsAsFactors = F)
mortalidad_2013=mortalidad_2013[grep("p",mortalidad_2013$X),]
mortalidad_2013=mortalidad_2013[,c(2,3)]
mortalidad_2013$DEFUNCIONES..INSCRITAS.EN.LÍNEA.Y.MANUAL..POR.TIPO.DE.INSCRIPCIÓN.Y.SEXO..SEGÚN.UBICACIÓN.DE.LA.OFICINA..2013=gsub("1","", mortalidad_2013$DEFUNCIONES..INSCRITAS.EN.LÍNEA.Y.MANUAL..POR.TIPO.DE.INSCRIPCIÓN.Y.SEXO..SEGÚN.UBICACIÓN.DE.LA.OFICINA..2013)
mortalidad_2013$X.1=gsub("\\.","", mortalidad_2013$X.1)
mortalidad_2013$X.1=trimws(mortalidad_2013$X.1, whitespace = "[\\h\\v]")
mortalidad_2013$X.1=as.numeric(mortalidad_2013$X.1)
colnames(mortalidad_2013)= c("PROVINCIA", "MORTA_13")
mortalidad_2013$PROVINCIA=gsub("Á","A", mortalidad_2013$PROVINCIA)
mortalidad_2013$PROVINCIA=gsub("É","E", mortalidad_2013$PROVINCIA)
mortalidad_2013$PROVINCIA=gsub("Í","I", mortalidad_2013$PROVINCIA)
mortalidad_2013$PROVINCIA=gsub("Ó","O", mortalidad_2013$PROVINCIA)
mortalidad_2013$PROVINCIA=gsub("Ú","U", mortalidad_2013$PROVINCIA)
mortalidad_2013$PROVINCIA=gsub("Ñ","N", mortalidad_2013$PROVINCIA)

#MORTALIDAD 2014
link_m14="https://docs.google.com/spreadsheets/d/e/2PACX-1vTPtV4DzpF7ebfYXYdLBKM5Hih4yf6DiOHuR_GGldDJ1EHQpS7-slcyeVhLOHbNGA/pub?gid=2106887050&single=true&output=csv"
mortalidad_2014= read.csv(link_m14, stringsAsFactors = F)
mortalidad_2014=mortalidad_2014[,c(4,6)]
mortalidad_2014=mortalidad_2014[-c(2086:2109),]
mortalidad_2014=mortalidad_2014[grep("A|B|C|D|E|F|G|H|I|J|K|L|M|N|O|P|Q|R|S|T|U|V|W|X|Y|Z",mortalidad_2014$X.2),]
mortalidad_2014$X.4=gsub("\\.","", mortalidad_2014$X.4)
mortalidad_2014$X.4=trimws(mortalidad_2014$X.4, whitespace = "[\\h\\v]")
mortalidad_2014$X.4= as.numeric(mortalidad_2014$X.4)
colnames(mortalidad_2014)=c("PROVINCIA","MORTA_14")
mortalidad_2014$PROVINCIA=gsub("Á","A", mortalidad_2014$PROVINCIA)
mortalidad_2014$PROVINCIA=gsub("É","E", mortalidad_2014$PROVINCIA)
mortalidad_2014$PROVINCIA=gsub("Í","I", mortalidad_2014$PROVINCIA)
mortalidad_2014$PROVINCIA=gsub("Ó","O", mortalidad_2014$PROVINCIA)
mortalidad_2014$PROVINCIA=gsub("Ú","U", mortalidad_2014$PROVINCIA)
mortalidad_2014$PROVINCIA=gsub("Ñ","N", mortalidad_2014$PROVINCIA)

#MORTALIDAD 2015
link_m15="https://docs.google.com/spreadsheets/d/e/2PACX-1vR4zquPj00h-XpV3YsPl_G20w2_GP1TyM2zD3XNx-0R-CvDpbWAKjd0jx7g-ozgDA/pub?gid=1923855542&single=true&output=csv"
mortalidad_2015=read.csv(link_m15, stringsAsFactors = F)
mortalidad_2015=mortalidad_2015[,c(6,10)]
mortalidad_2015=mortalidad_2015[grep("A|B|C|D|E|F|G|H|I|J|K|L|M|N|O|P|Q|R|S|T|U|V|W|X|Y|Z",mortalidad_2015$X.4),]
mortalidad_2015$X.8=gsub("\\.","", mortalidad_2015$X.8)
mortalidad_2015$X.8=trimws(mortalidad_2015$X.8, whitespace = "[\\h\\v]")
mortalidad_2015$X.8= as.numeric(mortalidad_2015$X.8)
colnames(mortalidad_2015)=c("PROVINCIA","MORTA_15")
mortalidad_2015$PROVINCIA=trimws(mortalidad_2015$PROVINCIA, whitespace = "[\\h\\v]")
mortalidad_2015$PROVINCIA=gsub("Á","A", mortalidad_2015$PROVINCIA)
mortalidad_2015$PROVINCIA=gsub("É","E", mortalidad_2015$PROVINCIA)
mortalidad_2015$PROVINCIA=gsub("Í","I", mortalidad_2015$PROVINCIA)
mortalidad_2015$PROVINCIA=gsub("Ó","O", mortalidad_2015$PROVINCIA)
mortalidad_2015$PROVINCIA=gsub("Ú","U", mortalidad_2015$PROVINCIA)
mortalidad_2015$PROVINCIA=gsub("Ñ","N", mortalidad_2015$PROVINCIA)
mortalidad_2015$PROVINCIA=gsub("RAYMONDI","RAIMONDI", mortalidad_2015$PROVINCIA)

#MORTALIDAD 2016
link_m16="https://docs.google.com/spreadsheets/d/e/2PACX-1vSNBDMBlVDik1jH2nuG2V-IvuKpMCLiRGqpytUQzk8mGQlju3gKhuuXVL2rwFssKw/pub?gid=637883358&single=true&output=csv"
mortalidad_2016= read.csv(link_m16, stringsAsFactors = F)
mortalidad_2016=mortalidad_2016[,c(4,8)]
mortalidad_2016=mortalidad_2016[grep("A|B|C|D|E|F|G|H|I|J|K|L|M|N|O|P|Q|R|S|T|U|V|W|X|Y|Z",mortalidad_2016$X.2),]
mortalidad_2016$X.6=gsub(" ","", mortalidad_2016$X.6)
mortalidad_2016$X.6=trimws(mortalidad_2016$X.6, whitespace = "[\\h\\v]")
mortalidad_2016$X.6= as.numeric(mortalidad_2016$X.6)
colnames(mortalidad_2016)=c("PROVINCIA","MORTA_16")
mortalidad_2016$PROVINCIA=trimws(mortalidad_2016$PROVINCIA, whitespace = "[\\h\\v]")
mortalidad_2016$PROVINCIA=gsub("Á","A", mortalidad_2016$PROVINCIA)
mortalidad_2016$PROVINCIA=gsub("É","E", mortalidad_2016$PROVINCIA)
mortalidad_2016$PROVINCIA=gsub("Í","I", mortalidad_2016$PROVINCIA)
mortalidad_2016$PROVINCIA=gsub("Ó","O", mortalidad_2016$PROVINCIA)
mortalidad_2016$PROVINCIA=gsub("Ú","U", mortalidad_2016$PROVINCIA)
mortalidad_2016$PROVINCIA=gsub("Ñ","N", mortalidad_2016$PROVINCIA)
mortalidad_2016$PROVINCIA=gsub("RAYMONDI","RAIMONDI", mortalidad_2016$PROVINCIA)

#MERGE DE LAS DATAS DE MORTALIDAD Y CALCULO PARA OBTENER EL PORCENTAJE
mort1112= merge(mortalidad_2011,mortalidad_2012, all.x=T, all.y=T, by="PROVINCIA")
mort111213= merge(mort1112,mortalidad_2013, all.x=T, all.y=T, by="PROVINCIA")
mort11121314= merge(mort111213, mortalidad_2014,all.x=T, all.y=T, by="PROVINCIA")
mort11121314=mort11121314[(-197),]
mort112131415= merge(mort11121314, mortalidad_2015,all.x=T, all.y=T, by="PROVINCIA")
mortalidad_f= merge(mort112131415, mortalidad_2016,all.x=T, all.y=T, by="PROVINCIA")
mortalidad_f$PROVINCIA=gsub("RAIMONDI","RAYMONDI", mortalidad_f$PROVINCIA)
mortalidad=merge(mortalidad_f,pobla_prov,all.x=T, all.y=T, by="PROVINCIA")
mortalidad$TASA_MORT= rowSums(mortalidad[,c(2:7)],na.rm = T)/6*100/mortalidad$POBLACION
mortalidad= mortalidad[,-c(2:8)]
```

    2.6.4. DIMENSION DE URBANO-RURAL Y MERGE DE LAS DIMENSIONES DE DEMOGRAFIA
```{r}
Link_ur= "https://docs.google.com/spreadsheets/d/e/2PACX-1vQO2tQ11yEAKDxlOKjxgLunWQ-T7v9IxV-cdYXB9RjGdUSs0TDWJaX6YgMBuMyVEA/pub?gid=1605173871&single=true&output=csv"
Urb_rur= read.csv(Link_ur, stringsAsFactors = F)
Urb_rur=Urb_rur[(-197),c(3:5)]
colnames(Urb_rur)=c("PROVINCIA", "URBANO","RURAL")
Urb_rur$URBANO=gsub(" ","",Urb_rur$URBANO)
Urb_rur$RURAL=gsub(" ","", Urb_rur$RURAL)
Urb_rur$PROVINCIA= trimws(Urb_rur$PROVINCIA, whitespace = "[\\h\\v]")
Urb_rur[,c(2,3)]=lapply(Urb_rur[,c(2,3)], as.numeric)

#MERGE DE ESTAS DIMENSIONES PARA CREAR LA VARIABLE DE CARACTERISTICAS DEMOGRAFICAS
Demo1= merge(Alfa, mortalidad, all.x=T, all.y=T, by="PROVINCIA")
Demo2= merge(Comu, Urb_rur, all.x=T, all.y=T, by="PROVINCIA")
DEMOG= merge(Demo1, Demo2, all.x=T, all.y=T, by="PROVINCIA")
```

    *Modificacion de cada data para poder hacer el merge de todas las dimensiones que necesitamos en la investigacion
```{r}
DEMOG$PROVINCIA=gsub("RAYMONDI", "RAIMONDI", DEMOG$PROVINCIA)
DESA_SOC$PROVINCIA=gsub("RAYMONDI", "RAIMONDI", DESA_SOC$PROVINCIA)
DATA_AMBIENTAL$PROVINCIA=gsub("CAÑETE", "CANETE", DATA_AMBIENTAL$PROVINCIA)
Par_pol$PROVINCIA=gsub("CAÑETE", "CANETE", Par_pol$PROVINCIA)
Con_Pre$PROVINCIA=gsub("CAÑETE", "CANETE", Con_Pre$PROVINCIA)
Par_pol$PROVINCIA= gsub("VILCASHUAMAN", "VILCAS HUAMAN",Par_pol$PROVINCIA )
Con_Pre$PROVINCIA= gsub("VILCASHUAMAN", "VILCAS HUAMAN",Con_Pre$PROVINCIA )
Par_pol$PROVINCIA= gsub("NAZCA", "NASCA", Par_pol$PROVINCIA)
Con_Pre$PROVINCIA= gsub("NAZCA", "NASCA", Con_Pre$PROVINCIA)
DESA_SOC$PROVINCIA= gsub("NAZCA", "NASCA", DESA_SOC$PROVINCIA)
DATA_PRES_EST$PROVINCIA= gsub("RAYMONDI", "RAIMONDI", DATA_PRES_EST$PROVINCIA )
DATA_PRES_EST$PROVINCIA= gsub("Ñ","N", DATA_PRES_EST$PROVINCIA)
```

    *Merge de todas las datas para construir la base de datos general del trabajo
```{r}
MERGE1=merge(conflictos,DATA_AMBIENTAL, all.x=T, all.y=T, by="PROVINCIA" )
MERGE2=merge(MERGE1, Par_pol, all.x=T, all.y=T, by="PROVINCIA")
MERGE3= merge(MERGE2, DATA_PRES_EST, all.x = T, all.y = T, by="PROVINCIA")
MERGE4= merge(MERGE3, DEMOG, all.x=T, all.y=T, by="PROVINCIA")
MERGE5= merge(MERGE4, Con_Pre, all.x=T, all.y=T, by="PROVINCIA")
DATA_TRABAJO= merge(MERGE5, DESA_SOC, all.x=T, all.y=T, by="PROVINCIA")
```

    *Creación de la variable dicotomica de la variable dependiente  
```{r}
DATA_TRABAJO$cero=0
DATA_TRABAJO$N_CONFLIC= rowSums(DATA_TRABAJO[,c(2,27)], na.rm=T)/1
DATA_TRABAJO$SIONO= ifelse(DATA_TRABAJO$N_CONFLIC>0,1,0)
DATA_TRABAJO$cero=NULL
DATA_TRABAJO$N_CONF= NULL
```


    ANALISIS FACTORIAL DE LAS VARIABLES PARA FORMAR LOS INDICES DE PRESENCIA ESTATAL, DESARROLLO SOCIAL Y EL INDICE DEMOGRAFICO

    1. INDICE DE PRESENCIA ESTATAL
```{r}
estado_s= scale(DATA_TRABAJO[,c(11,12,13)])
row.names(estado_s)=DATA_TRABAJO$PROVINCIA
estado_s= as.data.frame(estado_s) 
library(psych)
pearson1= cor(estado_s)
cor.plot(pearson1, 
         numbers=T, 
         upper=FALSE, 
         main = "Correlation", 
         show.legend = FALSE) 
```
```{r}
KMO(estado_s) 
```

```{r}
estado_sF <- fa(estado_s, 
                     nfactors=1, 
                     rotate="varimax") 
estado_sF$loadings 
```
```{r}
sort(estado_sF$communalities)
```
```{r}
sort(estado_sF$uniquenesses)
```
```{r}
sort(estado_sF$complexity)
```
```{r}
fa.diagram(estado_sF)
```
```{r}

estado_plus=as.data.frame(cbind(estado_s,estado_sF$scores))
names(estado_plus)[(4)]=('PRES_ESTATAL')
estado_plus$PROVINCIA=row.names(estado_plus)
row.names(estado_plus)=NULL
estado_plus=estado_plus[,c(4,5)]
```

    2. VARIABLE INDICE DEMOGRAFICO
```{r}
demogr_s=scale(DATA_TRABAJO[,c(15,17,18,20)])
row.names(demogr_s)=DATA_TRABAJO$PROVINCIA
demogr_s=as.data.frame(demogr_s)
library(psych)
pearson2 = cor(demogr_s)
cor.plot(pearson2, 
         numbers=T, 
         upper=FALSE, 
         main = "Correlation", 
         show.legend = FALSE)
```
```{r}
KMO(demogr_s)
```

```{r}
demogr_sF <- fa(demogr_s, 
                     nfactors=1, 
                     rotate="varimax"
                      )
demogr_sF$loadings
```

```{r}
sort(demogr_sF$communalities)
```
```{r}
sort(demogr_sF$uniquenesses)
```
```{r}
sort(demogr_sF$complexity)
```
```{r}
fa.diagram(demogr_sF)
```
```{r}
demogr_plus=as.data.frame(cbind(demogr_s,demogr_sF$scores))
names(demogr_plus)[(5)]=('IND_DEMOG')
demogr_plus$PROVINCIA=row.names(demogr_plus)
row.names(demogr_plus)=NULL
demogr_plus=demogr_plus[,c(5,6)]
```

    3. VARIABLE DESARROLLO SOCIAL
```{r}
DS_s=scale(DATA_TRABAJO[,c(23:25)])
row.names(DS_s)=DATA_TRABAJO$PROVINCIA
DS_s=as.data.frame(DS_s)
library(psych)
pearson3 = cor(DS_s)
cor.plot(pearson3, 
         numbers=T, 
         upper=FALSE, 
         main = "Correlation", 
         show.legend = FALSE)
```
```{r}
KMO(DS_s)
```

```{r}
DS_sF <- fa(DS_s, 
                     nfactors=1, 
                     rotate="varimax"
                      )
DS_sF$loadings
```

```{r}
sort(DS_sF$communalities)
```
```{r}
sort(DS_sF$uniquenesses)
```
```{r}
sort(DS_sF$complexity)
```
```{r}
fa.diagram(DS_sF)
```
```{r}
DS_plus=as.data.frame(cbind(DS_s,DS_sF$scores))
names(DS_plus)[(4)]=('DES_SOCIAL')
DS_plus$PROVINCIA=row.names(DS_plus)
row.names(DS_plus)=NULL
DS_plus=DS_plus[,c(4,5)]
```

    ESTANDARIZACION DE LAS DEMAS VARIABLES NUMERICAS Y MERGE DE LOS INDICES CREADOS MAS LAS VARIABLES ESTANDARIZADAS
```{r}
data_s= scale(DATA_TRABAJO[,c(2,3,4,5)])
row.names(data_s)=DATA_TRABAJO$PROVINCIA
data_s=as.data.frame(data_s)
data_s$PROVINCIA=row.names(data_s)
data_a= merge(DATA_TRABAJO, estado_plus, all.x=T, all.y=T, by="PROVINCIA")
data_b= merge(data_a, demogr_plus, all.x=T, all.y=T, by="PROVINCIA")
data_c= merge(data_b, DS_plus, all.x=T, all.y=T, by="PROVINCIA")
data_c=data_c[,c(1,27,28,29,30,22)]
DATA_FINAL= merge(data_c, data_s, all.x=T, all.y=T, by="PROVINCIA")
```

    REGRESION LOGISTICA BINOMIAL
    - VD= CONFLICTIVIDAD A NIVEL PROVINCIA (¿Hubo conflicto? Si o No)
    - VI= Presencia estatal, indice demografico, medioambiente, participacion politica, desarrollo social, consulta previa

```{r}
modelo1 <- glm( SIONO ~ PRES_ESTATAL+IND_DEMOG+DES_SOCIAL+HUBO+ALTITUD+DENUNCIAS_TOTALES+BLANCOS+AUSENTISMO, 
               data = DATA_FINAL, 
              family= "binomial")
summary(modelo1)
```

    *Los efectos marginales para ver como estas variables afectan en la existencia de conflictos socioambientales en las provincias durante el 2011 al 2016
```{r}
library(margins)
(modelo1M = margins(modelo1))
```
```{r}
(mr=summary(modelo1M))
```
